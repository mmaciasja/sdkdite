<form class="flexcol {{cssClass}}" autocomplete="off">
    <header class="sheet-header">
        <img class="profile-img" src="{{data.img}}" data-edit="img" title="{{data.name}}" />
        <div class="header-fields">
            <h1 class="charname">
                <input name="name" type="text" value="{{data.name}}" placeholder="Virtue Name" />
            </h1>
            
            <div class="virtue-fields">
                <div class="field-row">
                    <div class="field-group">
                        <label>Branch</label>
                        <select name="system.branch" data-dtype="String">
                            <option value="">--Select Branch--</option>
                            <option value="Legacy" {{#if (eq systemData.branch "Legacy")}}selected{{/if}}>Legacy</option>
                            <option value="Omnifera" {{#if (eq systemData.branch "Omnifera")}}selected{{/if}}>Omnifera</option>
                            <option value="Vulcanotech" {{#if (eq systemData.branch "Vulcanotech")}}selected{{/if}}>Vulcanotech</option>
                            <option value="Veil" {{#if (eq systemData.branch "Veil")}}selected{{/if}}>Veil</option>
                            <option value="Defect" {{#if (eq systemData.branch "Defect")}}selected{{/if}}>Defect</option>
                        </select>
                    </div>
                    
                    <div class="field-group">
                        <label>Type</label>
                        <select name="system.type" data-dtype="String">
                            <option value="">--Select Type--</option>
                            <option value="Fragmented" {{#if (eq systemData.type "Fragmented")}}selected{{/if}}>Fragmented</option>
                            <option value="Kindred" {{#if (eq systemData.type "Kindred")}}selected{{/if}}>Kindred</option>
                            <option value="Harmonized" {{#if (eq systemData.type "Harmonized")}}selected{{/if}}>Harmonized</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </header>

    {{!-- Sheet Tab Navigation --}}
    <nav class="sheet-tabs tabs" data-group="primary">
        <a class="item" data-tab="description">Description</a>
        <a class="item" data-tab="requirements">Requirements</a>
        <a class="item" data-tab="mechanic">Mechanic</a>
    </nav>

    {{!-- Sheet Body --}}
    <section class="sheet-body">

        {{!-- Description Tab --}}
        <div class="tab" data-group="primary" data-tab="description">
            {{editor descriptionHTML target="system.description" button=true editable=editable engine="prosemirror"}}
        </div>

        {{!-- Requirements Tab --}}
        <div class="tab" data-group="primary" data-tab="requirements">
            <div class="requirements-container">
                
                {{!-- Minimum Stats Section --}}
                <div class="req-section stats-section">
                    <h3 class="req-section-title">üìä Minimum Stats Required</h3>
                    <div class="stats-grid">
                        <div class="stat-requirement">
                            <label>Strength</label>
                            <input type="number" name="system.requirements.stats.strength" value="{{systemData.requirements.stats.strength}}" placeholder="‚Äî" min="0"/>
                        </div>
                        <div class="stat-requirement">
                            <label>Constitution</label>
                            <input type="number" name="system.requirements.stats.constitution" value="{{systemData.requirements.stats.constitution}}" placeholder="‚Äî" min="0"/>
                        </div>
                        <div class="stat-requirement">
                            <label>Dexterity</label>
                            <input type="number" name="system.requirements.stats.dexterity" value="{{systemData.requirements.stats.dexterity}}" placeholder="‚Äî" min="0"/>
                        </div>
                        <div class="stat-requirement">
                            <label>Charisma</label>
                            <input type="number" name="system.requirements.stats.charisma" value="{{systemData.requirements.stats.charisma}}" placeholder="‚Äî" min="0"/>
                        </div>
                        <div class="stat-requirement">
                            <label>Intelligence</label>
                            <input type="number" name="system.requirements.stats.intelligence" value="{{systemData.requirements.stats.intelligence}}" placeholder="‚Äî" min="0"/>
                        </div>
                    </div>
                </div>

                {{!-- Prerequisites Section --}}
                <div class="req-section prereq-section">
                    <h3 class="req-section-title">‚úì Prerequisites</h3>
                    <div class="prereq-grid">
                        <div class="prereq-item">
                            <label>Required Virtues</label>
                            <input type="text" name="system.requirements.virtues" value="{{systemData.requirements.virtues}}" placeholder="None"/>
                            <span class="help-text">Comma-separated names</span>
                        </div>
                        <div class="prereq-item">
                            <label>Required Skills</label>
                            <input type="text" name="system.requirements.skills" value="{{systemData.requirements.skills}}" placeholder="None"/>
                            <span class="help-text">Comma-separated names</span>
                        </div>
                    </div>
                </div>
                
                {{!-- Incompatibilities Section --}}
                <div class="req-section incomp-section">
                    <h3 class="req-section-title">‚ö†Ô∏è Branch Incompatibilities</h3>
                    <p class="section-description">This virtue cannot be taken with the following branches:</p>
                    <div class="branch-options">
                        <label class="branch-option">
                            <input type="checkbox" name="system.requirements.incompatibleBranches" value="Legacy" {{#if branchChecks.Legacy}}checked{{/if}}/>
                            <span class="branch-name">Legacy</span>
                        </label>
                        <label class="branch-option">
                            <input type="checkbox" name="system.requirements.incompatibleBranches" value="Omnifera" {{#if branchChecks.Omnifera}}checked{{/if}}/>
                            <span class="branch-name">Omnifera</span>
                        </label>
                        <label class="branch-option">
                            <input type="checkbox" name="system.requirements.incompatibleBranches" value="Vulcanotech" {{#if branchChecks.Vulcanotech}}checked{{/if}}/>
                            <span class="branch-name">Vulcanotech</span>
                        </label>
                        <label class="branch-option">
                            <input type="checkbox" name="system.requirements.incompatibleBranches" value="Veil" {{#if branchChecks.Veil}}checked{{/if}}/>
                            <span class="branch-name">Veil</span>
                        </label>
                        <label class="branch-option">
                            <input type="checkbox" name="system.requirements.incompatibleBranches" value="Defect" {{#if branchChecks.Defect}}checked{{/if}}/>
                            <span class="branch-name">Defect</span>
                        </label>
                    </div>
                </div>
                
            </div>
        </div>

        {{!-- Mechanic Tab --}}
        <div class="tab" data-group="primary" data-tab="mechanic">
            
            {{!-- Stat Modifiers Section --}}
            <div class="requirements-container">
                <div class="req-section stats-section">
                    <h3 class="req-section-title">‚ö° Stat Modifiers</h3>
                    <p class="section-description">Bonuses/penalties applied when this virtue is equipped (use negative numbers for penalties)</p>
                    
                    <div class="modifiers-grid">
                        {{!-- Primary Stats --}}
                        <div class="modifier-group">
                            <h4>Primary Stats</h4>
                            <div class="stats-grid">
                                <div class="stat-requirement">
                                    <label>Strength</label>
                                    <input type="number" name="system.modifiers.strength" value="{{systemData.modifiers.strength}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Constitution</label>
                                    <input type="number" name="system.modifiers.constitution" value="{{systemData.modifiers.constitution}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Dexterity</label>
                                    <input type="number" name="system.modifiers.dexterity" value="{{systemData.modifiers.dexterity}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Charisma</label>
                                    <input type="number" name="system.modifiers.charisma" value="{{systemData.modifiers.charisma}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Intelligence</label>
                                    <input type="number" name="system.modifiers.intelligence" value="{{systemData.modifiers.intelligence}}" placeholder="0"/>
                                </div>
                            </div>
                        </div>
                        
                        {{!-- Combat Stats --}}
                        <div class="modifier-group">
                            <h4>Combat Stats</h4>
                            <div class="stats-grid">
                                <div class="stat-requirement">
                                    <label>Strike</label>
                                    <input type="number" name="system.modifiers.strike" value="{{systemData.modifiers.strike}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Insight</label>
                                    <input type="number" name="system.modifiers.insight" value="{{systemData.modifiers.insight}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Speed</label>
                                    <input type="number" name="system.modifiers.speed" value="{{systemData.modifiers.speed}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Defense</label>
                                    <input type="number" name="system.modifiers.defense" value="{{systemData.modifiers.defense}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Will</label>
                                    <input type="number" name="system.modifiers.will" value="{{systemData.modifiers.will}}" placeholder="0"/>
                                </div>
                            </div>
                        </div>
                        
                        {{!-- Resources --}}
                        <div class="modifier-group">
                            <h4>Resources</h4>
                            <div class="stats-grid">
                                <div class="stat-requirement">
                                    <label>Health</label>
                                    <input type="number" name="system.modifiers.health" value="{{systemData.modifiers.health}}" placeholder="0"/>
                                </div>
                                <div class="stat-requirement">
                                    <label>Power</label>
                                    <input type="number" name="system.modifiers.power" value="{{systemData.modifiers.power}}" placeholder="0"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            {{!-- Mechanic Description --}}
            <div class="requirements-container" style="margin-top: 15px;">
                <div class="req-section">
                    <h3 class="req-section-title">üìù Mechanic Description</h3>
                    {{editor mechanicHTML target="system.mechanic" button=true editable=editable engine="prosemirror"}}
                </div>
            </div>
        </div>
    </section>
</form>
